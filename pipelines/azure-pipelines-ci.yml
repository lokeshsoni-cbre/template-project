trigger:
  branches:
    include:
      - main

pr:
  branches:
    include:
      - main

pool:
  vmImage: 'ubuntu-latest'

steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: '3.12'
    displayName: 'Use Python 3.12'

  - script: |
      curl -LsSf https://astral.sh/uv/install.sh | sh
      export PATH="$HOME/.local/bin:$PATH"
      uv sync --all-groups
    displayName: 'Install uv and dependencies'

  - script: |
      export PATH="$HOME/.local/bin:$PATH"
      uv run ruff check src/ --output-format=github
    displayName: 'Ruff lint check'

  - script: |
      export PATH="$HOME/.local/bin:$PATH"
      uv run ruff format --check src/
    displayName: 'Ruff format check'
